<!DOCTYPE html>
<html>
<head>
    <title>GeoChatbot</title>
    <style>
        body { font-family: Arial; margin: 40px; }
        #response { margin-top: 20px; white-space: pre-wrap; }
        input, button { padding: 10px; font-size: 16px; }
    </style>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/jquery-jsonview/1.2.3/jquery.jsonview.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-jsonview/1.2.3/jquery.jsonview.min.js"></script>
</head>
<body>
    <h1>GeoChatbot ðŸ’¬</h1>
    <input type="text" id="question" placeholder="Ask a question..." size="50" />
    <button onclick="send()">Send</button>
    <div id="response"></div>
    <div id="context" style="margin-top:10px; color: #555; font-size: 0.95em;"></div>
    <div id="json-context" style="margin-top:10px;"></div>
    <script>
        function send() {
            const question = document.getElementById("question").value;
            document.getElementById("response").innerText = "Thinking...";
            document.getElementById("context").innerText = "";
            document.getElementById("json-context").innerHTML = "";
            fetch("/chat", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ question })
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById("response").innerText = data.answer;
                if (typeof data.context === 'object') {
                    document.getElementById("context").innerText = 'Context used:';
                    $("#json-context").JSONView(data.context, { collapsed: false });
                } else {
                    document.getElementById("context").innerText = data.context ? `Context used:\n${data.context}` : '';
                }
            });
        }
    </script>
</body>
</html>
